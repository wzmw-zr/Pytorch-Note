# 模型保存与加载

有时候出于外界原因，模型训练会被终止，为了不让训练得到的数据(模型的、优化器的)丢失，我们要定时保存模型的数据，如果模型意外终止，我们可以加载回来继续训练。

## 一、`torch.save()`—模型保存

```python
def save(obj, 
         f: Union[str, os.PathLike, BinaryIO],
         pickle_module=pickle, 
         pickle_protocol=DEFAULT_PROTOCOL, _use_new_zipfile_serialization=True) -> None:
    
    _check_dill_version(pickle_module)

    with _open_file_like(f, 'wb') as opened_file:
        if _use_new_zipfile_serialization:
            with _open_zipfile_writer(opened_file) as opened_zipfile:
                _save(obj, opened_zipfile, pickle_module, pickle_protocol)
                return
        _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
```

obj参数就是我们要保存的模型、优化器(其他对象也行)。

f参数是保存的文件路径。



## 二、`torch.load()`—模型加载

```python
def save(obj, 
         f: Union[str, os.PathLike, BinaryIO],
         pickle_module=pickle, 
         pickle_protocol=DEFAULT_PROTOCOL, _use_new_zipfile_serialization=True) -> None:
    
    _check_dill_version(pickle_module)

    with _open_file_like(f, 'wb') as opened_file:
        if _use_new_zipfile_serialization:
            with _open_zipfile_writer(opened_file) as opened_zipfile:
                _save(obj, opened_zipfile, pickle_module, pickle_protocol)
                return
        _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
```

参数解释同上。